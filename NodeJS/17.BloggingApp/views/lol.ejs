<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head')%>
    <title>Profile</title>
</head>

<body class="bg-gray-100 min-h-screen">
    <%- include('./partials/navbar')%>

    <!-- Profile Header -->
    <div class="bg-white shadow">
        <div class="max-w-4xl mx-auto px-6 py-6 flex items-center gap-4">
            <img 
                src="<%= user?.profilePicUrl || '/public/images/userAvatar.avif' %>" 
                class="w-20 h-20 rounded-full object-cover border"
            />
            <div>
                <h1 class="text-2xl font-semibold"><%= user?.username || 'User' %></h1>
                <p class="text-gray-500 text-sm"><%= user?.email || '' %></p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto px-4 mt-6 grid grid-cols-1 md:grid-cols-3 gap-6">

        <!-- Left Column (About / Stats placeholder) -->
        <div class="md:col-span-1 space-y-4">
            <div class="bg-white rounded-xl shadow p-4">
                <h3 class="font-semibold mb-2">About</h3>
                <p class="text-sm text-gray-600">
                    This is your personal feed. Your posts live here.
                </p>
            </div>
        </div>

        <!-- Right Column (Create + Feed) -->
        <div class="md:col-span-2 space-y-4">

            <!-- Create Post -->
            <div class="bg-white rounded-xl shadow p-4">
                <form action="/blog/create" method="POST" class="space-y-3">

                    <input 
                        type="text" 
                        name="title" 
                        placeholder="Post title"
                        required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />

                    <textarea 
                        name="content" 
                        rows="3"
                        placeholder="What's on your mind?"
                        required
                        class="w-full px-4 py-2 border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
                    ></textarea>

                    <input 
                        type="text" 
                        name="imgUrl" 
                        placeholder="Image URL (optional)"
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />

                    <div class="flex justify-end">
                        <button 
                            type="submit"
                            class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition"
                        >
                            Post
                        </button>
                    </div>
                </form>
            </div>

            <!-- Feed -->
            <% if (posts.length === 0) { %>
                <div class="bg-white p-4 rounded-xl shadow text-gray-500 text-center">
                    No posts yet. Write the first one.
                </div>
            <% } %>

            <% posts.forEach(post => { %>
                <div class="bg-white rounded-xl shadow">
                    <div class="p-4 flex items-center gap-3 border-b">
                        <img 
                            src="<%= post.createdBy.profilePicUrl || '/public/images/userAvatar.avif' %>" 
                            class="w-10 h-10 rounded-full object-cover"
                        />
                        <div>
                            <p class="font-semibold leading-tight"><%= post.createdBy.username %></p>
                            <p class="text-xs text-gray-500">
                                <%= new Date(post.createdAt).toLocaleString() %>
                            </p>
                        </div>
                    </div>

                    <div class="p-4">
                        <h3 class="text-lg font-semibold mb-1"><%= post.title %></h3>
                        <p class="text-gray-700 whitespace-pre-line"><%= post.content %></p>

                        <% if (post.imgUrl) { %>
                            <img 
                                src="<%= post.imgUrl %>" 
                                class="mt-3 w-full max-h-[420px] object-cover rounded-lg"
                            />
                        <% } %>
                    </div>
                </div>
            <% }) %>

        </div>
    </div>

    <%- include('./partials/script')%>
</body>

</html>